{"version":3,"sources":["file:///Users/xiejiapei/SpeedTaxi/assets/script/i18nMaster/runtime-scripts/LocalizedSprite.ts"],"names":["_decorator","Component","Sprite","error","SpriteFrameSet","ccclass","property","LocalizedSprite","type","displayOrder","sprite","onLoad","fetchRender","getComponent","updateSprite","window","i18nConfig","curLang","getSpriteFrameByLang","lang","i","spriteFrameSet","length","language","spriteFrame","editor","executeInEditMode","inspector","menu"],"mappings":";;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAuBC,MAAAA,M,OAAAA,M;AAAQC,MAAAA,K,OAAAA,K;;AAC7CC,MAAAA,c;;;;;;;OAED;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBN,U;;yBAGTO,e,WADpBF,OAAO,CAAC,iBAAD,C,UAWHC,QAAQ,CAAC;AAACE,QAAAA,IAAI,EAAE;AAAA;AAAA,6CAAP;AAAyBC,QAAAA,YAAY,EAAE;AAAvC,OAAD,C,sCAXb,MACqBF,eADrB,SAC6CN,SAD7C,CACsD;AAAA;AAAA;AAAA,eAElDS,MAFkD,GAE1B,IAF0B;;AAAA;AAAA;;AAalDC,QAAAA,MAAM,GAAI;AACN,eAAKC,WAAL;AACH;;AAEDA,QAAAA,WAAW,GAAI;AACX,cAAIF,MAAM,GAAG,KAAKG,YAAL,CAAkBX,MAAlB,CAAb;;AACA,cAAIQ,MAAJ,EAAY;AACR,iBAAKA,MAAL,GAAcA,MAAd;AACA,iBAAKI,YAAL,CAAkBC,MAAM,CAACC,UAAP,CAAkBC,OAApC;AACA;AACH;AACJ;;AAEDC,QAAAA,oBAAoB,CAAEC,IAAF,EAAgB;AAChC,eAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKC,cAAL,CAAoBC,MAAxC,EAAgD,EAAEF,CAAlD,EAAqD;AACjD,gBAAI,KAAKC,cAAL,CAAoBD,CAApB,EAAuBG,QAAvB,KAAoCJ,IAAxC,EAA8C;AAC1C,qBAAO,KAAKE,cAAL,CAAoBD,CAApB,EAAuBI,WAA9B;AACH;AACJ;AACJ;;AAEDV,QAAAA,YAAY,CAAES,QAAF,EAAoB;AAC5B,cAAI,CAAC,KAAKb,MAAV,EAAkB;AACdP,YAAAA,KAAK,CAAC,iEAAD,CAAL;AACA;AACH;;AAED,cAAIqB,WAAW,GAAG,KAAKN,oBAAL,CAA0BK,QAA1B,CAAlB;;AAEA,cAAI,CAACC,WAAD,IAAgB,KAAKH,cAAL,CAAoB,CAApB,CAApB,EAA4C;AACxCG,YAAAA,WAAW,GAAG,KAAKH,cAAL,CAAoB,CAApB,EAAuBG,WAArC;AACH;;AAED,cAAIA,WAAJ,EAAiB;AACb,iBAAKd,MAAL,CAAYc,WAAZ,GAA0BA,WAA1B;AACH;AACJ;;AAjDiD,O,UAI3CC,M,GAAS;AACZC,QAAAA,iBAAiB,EAAE,IADP;AAEZC,QAAAA,SAAS,EAAE,+CAFC;AAGZC,QAAAA,IAAI,EAAE;AAHM,O;;;;;iBAOmB,E","sourcesContent":["import { _decorator, Component, Node, view, Sprite, error } from \"cc\";\nimport SpriteFrameSet from \"./SpriteFrameSet\";\n\nconst { ccclass, property } = _decorator;\n\n@ccclass(\"LocalizedSprite\")\nexport default class LocalizedSprite extends Component{\n\n    sprite: Sprite | null = null;\n\n    static editor = {\n        executeInEditMode: true,\n        inspector: 'packages://i18n/inspector/localized-sprite.js',\n        menu: 'i18n/LocalizedSprite'\n    }\n\n    @property({type: [SpriteFrameSet], displayOrder: 1})\n    spriteFrameSet: SpriteFrameSet[] = [];\n\n    onLoad () {\n        this.fetchRender();\n    }\n\n    fetchRender () {\n        let sprite = this.getComponent(Sprite);\n        if (sprite) {\n            this.sprite = sprite;\n            this.updateSprite(window.i18nConfig.curLang);\n            return;\n        }\n    }\n\n    getSpriteFrameByLang (lang: string) {\n        for (let i = 0; i < this.spriteFrameSet.length; ++i) {\n            if (this.spriteFrameSet[i].language === lang) {\n                return this.spriteFrameSet[i].spriteFrame;\n            }\n        }\n    }\n\n    updateSprite (language: string) {\n        if (!this.sprite) {\n            error('Failed to update localized sprite, sprite component is invalid!');\n            return;\n        }\n\n        let spriteFrame = this.getSpriteFrameByLang(language);\n\n        if (!spriteFrame && this.spriteFrameSet[0]) {\n            spriteFrame = this.spriteFrameSet[0].spriteFrame;\n        }\n\n        if (spriteFrame) {\n            this.sprite.spriteFrame = spriteFrame;\n        }\n    }\n}\n\n\n"]}
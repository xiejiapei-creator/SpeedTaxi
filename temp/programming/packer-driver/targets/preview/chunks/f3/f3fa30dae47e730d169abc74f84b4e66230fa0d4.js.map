{"version":3,"sources":["file:///Users/xiejiapei/SpeedTaxi/assets/script/framework/oneToMultiListener.ts"],"names":["_decorator","ccclass","oneToMultiListener","on","eventName","handler","target","objHandler","handlerList","handlers","i","length","push","off","oldObj","splice","dispatchEvent","args","apply"],"mappings":";;;;;;;;AAAgBA,MAAAA,U,OAAAA,U;;;;;;;OACV;AAAEC,QAAAA;AAAF,O,GAAcD,U;;oCAGPE,kB,WADZD,OAAO,CAAC,oBAAD,C,2BAAR,MACaC,kBADb,CACgC;AAG5B;AACgB,eAAFC,EAAE,CAAEC,SAAF,EAAqBC,OAArB,EAAwCC,MAAxC,EAAsD;AAClE,cAAMC,UAAU,GAAG;AAACF,YAAAA,OAAO,EAAEA,OAAV;AAAmBC,YAAAA,MAAM,EAAEA;AAA3B,WAAnB;AACA,cAAIE,WAAW,GAAG,KAAKC,QAAL,CAAcL,SAAd,CAAlB;;AACA,cAAI,CAACI,WAAL,EAAkB;AACdA,YAAAA,WAAW,GAAG,EAAd;AACA,iBAAKC,QAAL,CAAcL,SAAd,IAA2BI,WAA3B;AACH;;AAED,eAAK,IAAIE,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGF,WAAW,CAACG,MAAhC,EAAwCD,CAAC,EAAzC,EAA6C;AACzC,gBAAI,CAACF,WAAW,CAACE,CAAD,CAAhB,EAAqB;AACjBF,cAAAA,WAAW,CAACE,CAAD,CAAX,GAAiBH,UAAjB;AACA,qBAAOG,CAAP;AACH;AACJ;;AAEDF,UAAAA,WAAW,CAACI,IAAZ,CAAiBL,UAAjB;AAEA,iBAAOC,WAAW,CAACG,MAAnB;AACH;;AAED;AACiB,eAAHE,GAAG,CAAET,SAAF,EAAqBC,OAArB,EAAwCC,MAAxC,EAAsD;AACnE,cAAME,WAAW,GAAG,KAAKC,QAAL,CAAcL,SAAd,CAApB;;AAEA,cAAI,CAACI,WAAL,EAAkB;AACd;AACH;;AAED,eAAK,IAAIE,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGF,WAAW,CAACG,MAAhC,EAAwCD,CAAC,EAAzC,EAA6C;AACzC,gBAAMI,MAAM,GAAGN,WAAW,CAACE,CAAD,CAA1B;;AACA,gBAAII,MAAM,CAACT,OAAP,KAAmBA,OAAnB,KAA+B,CAACC,MAAD,IAAWA,MAAM,KAAKQ,MAAM,CAACR,MAA5D,CAAJ,EAAyE;AACrEE,cAAAA,WAAW,CAACO,MAAZ,CAAmBL,CAAnB,EAAsB,CAAtB;AACA;AACH;AACJ;AACJ;;AAED;AAC2B,eAAbM,aAAa,CAAEZ,SAAF,EAAmC;AAC1D,cAAMI,WAAW,GAAG,KAAKC,QAAL,CAAcL,SAAd,CAApB;;AACA,cAAI,CAACI,WAAL,EAAkB;AACd;AACH;;AAJyD,4CAAXS,IAAW;AAAXA,YAAAA,IAAW;AAAA;;AAM1D,eAAK,IAAIP,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGF,WAAW,CAACG,MAAhC,EAAwCD,CAAC,EAAzC,EAA6C;AACzC,gBAAMH,UAAU,GAAGC,WAAW,CAACE,CAAD,CAA9B;;AACA,gBAAIH,UAAU,CAACF,OAAf,EAAwB;AACpBE,cAAAA,UAAU,CAACF,OAAX,CAAmBa,KAAnB,CAAyBX,UAAU,CAACD,MAApC,EAA4CW,IAA5C;AACH;AACJ;AACJ;;AAtD2B,O,UACrBR,Q;;AAsDV","sourcesContent":["import { error, _decorator } from \"cc\";\nconst { ccclass } = _decorator;\n\n@ccclass(\"oneToMultiListener\")\nexport class oneToMultiListener {\n    static handlers: { [name: string]: { handler: Function, target: any }[] };\n\n    // 注册监听事件\n    public static on (eventName: string, handler: Function, target?: any) {\n        const objHandler = {handler: handler, target: target};\n        let handlerList = this.handlers[eventName];\n        if (!handlerList) {\n            handlerList = [];\n            this.handlers[eventName] = handlerList;\n        }\n\n        for (var i = 0; i < handlerList.length; i++) {\n            if (!handlerList[i]) {\n                handlerList[i] = objHandler;\n                return i;\n            }\n        }\n\n        handlerList.push(objHandler);\n\n        return handlerList.length;\n    };\n\n    // 取消监听事件\n    public static off (eventName: string, handler: Function, target?: any) {\n        const handlerList = this.handlers[eventName];\n\n        if (!handlerList) {\n            return;\n        }\n\n        for (let i = 0; i < handlerList.length; i++) {\n            const oldObj = handlerList[i];\n            if (oldObj.handler === handler && (!target || target === oldObj.target)) {\n                handlerList.splice(i, 1);\n                break;\n            }\n        }\n    };\n\n    // 派发事件\n    public static dispatchEvent (eventName: string, ...args: any) {\n        const handlerList = this.handlers[eventName];\n        if (!handlerList) {\n            return;\n        }\n\n        for (let i = 0; i < handlerList.length; i++) {\n            const objHandler = handlerList[i];\n            if (objHandler.handler) {\n                objHandler.handler.apply(objHandler.target, args);\n            }\n        }\n    };\n};"]}
{"version":3,"sources":["file:///Users/xiejiapei/SpeedTaxi/assets/script/framework/oneToMultiListener.ts"],"names":["error","_decorator","ccclass","oneToMultiListener","on","eventName","handler","target","objHandler","handlerList","handlers","i","length","push","off","oldObj","splice","dispatchEvent","args","params","arguments","apply","setSupportEventList","arrSupportEvent","Array","supportEvent"],"mappings":"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","sourcesContent":["import { error, _decorator } from \"cc\";\nconst { ccclass } = _decorator;\n\n@ccclass(\"oneToMultiListener\")\nexport class oneToMultiListener {\n    static handlers: { [name: string]: { handler: Function, target: any }[] };\n    static supportEvent: { [name: string]: string };\n\n    public static on (eventName: string, handler: Function, target?: any) {\n        const objHandler = {handler: handler, target: target};\n        let handlerList = this.handlers[eventName];\n        if (!handlerList) {\n            handlerList = [];\n            this.handlers[eventName] = handlerList;\n        }\n\n        for (var i = 0; i < handlerList.length; i++) {\n            if (!handlerList[i]) {\n                handlerList[i] = objHandler;\n                return i;\n            }\n        }\n\n        handlerList.push(objHandler);\n\n        return handlerList.length;\n    };\n\n    public static off (eventName: string, handler: Function, target?: any) {\n        const handlerList = this.handlers[eventName];\n\n        if (!handlerList) {\n            return;\n        }\n\n        for (let i = 0; i < handlerList.length; i++) {\n            const oldObj = handlerList[i];\n            if (oldObj.handler === handler && (!target || target === oldObj.target)) {\n                handlerList.splice(i, 1);\n                break;\n            }\n        }\n    };\n\n    public static dispatchEvent (eventName: string, ...args: any) {\n        // if (this.supportEvent !== null && !this.supportEvent.hasOwnProperty(eventName)) {\n        //     cc.error(\"please add the event into clientEvent.js\");\n        //     return;\n        // }\n\n        const handlerList = this.handlers[eventName];\n\n        const params = [];\n        let i;\n        for (i = 1; i < arguments.length; i++) {\n            params.push(arguments[i]);\n        }\n\n        if (!handlerList) {\n            return;\n        }\n\n        for (i = 0; i < handlerList.length; i++) {\n            const objHandler = handlerList[i];\n            if (objHandler.handler) {\n                objHandler.handler.apply(objHandler.target, args);\n            }\n        }\n    };\n\n    public static setSupportEventList (arrSupportEvent: string[]) {\n        if (!(arrSupportEvent instanceof Array)) {\n            error(\"supportEvent was not array\");\n            return false;\n        }\n\n        this.supportEvent = {};\n        for (let i in arrSupportEvent) {\n            const eventName = arrSupportEvent[i];\n            this.supportEvent[eventName] = i;\n        }\n\n\n        return true;\n    };\n};"]}
{"version":3,"sources":["file:///Users/xiejiapei/NewProject_1/assets/script/ui/fight/revive.ts"],"names":["_decorator","Component","Sprite","Widget","uiManager","clientEvent","gameLogic","constant","ccclass","property","revive","closeCb","countDownTime","currentTime","isCountDowning","start","show","closeCallback","spCountDown","fillRange","updateRewardIcon","SHARE_FUNCTION","RELIVE","spIcon","onBtnReviveClick","openReward","err","dispatchEvent","instance","hideDialog","onBtnSkipClick"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAUSA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,M,OAAAA,M;AAAQC,MAAAA,M,OAAAA,M;;AAC/BC,MAAAA,S,iBAAAA,S;;AACAC,MAAAA,W,iBAAAA,W;;AACAC,MAAAA,S,iBAAAA,S;;AACAC,MAAAA,Q,iBAAAA,Q;;;;;;;OACH;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBT,U;;wBAGjBU,M,WADZF,OAAO,CAAC,QAAD,C,UAGHC,QAAQ,CAACP,MAAD,C,UAGRO,QAAQ,CAACP,MAAD,C,UAGRO,QAAQ,CAACN,MAAD,C,2BATb,MACaO,MADb,SAC4BT,SAD5B,CACsC;AAAA;AAAA;;AAAA;;AAAA;;AAAA;;AAAA,eAWlCU,OAXkC,GAWP,IAXO;AAAA,eAYlCC,aAZkC,GAYlB,CAZkB;AAAA,eAalCC,WAbkC,GAapB,CAboB;AAAA,eAclCC,cAdkC,GAcjB,KAdiB;AAAA;;AAgBlCC,QAAAA,KAAK,GAAI,CACL;AACH;;AAEDC,QAAAA,IAAI,CAAEC,aAAF,EAA2B;AAC3B,eAAKN,OAAL,GAAeM,aAAf,CAD2B,CAE3B;;AACA,eAAKL,aAAL,GAAqB,CAArB;AACA,eAAKC,WAAL,GAAmB,CAAnB;AACA,eAAKK,WAAL,CAAiBC,SAAjB,GAA6B,CAA7B;AACA,eAAKL,cAAL,GAAsB,IAAtB;AAEA;AAAA;AAAA,sCAAUM,gBAAV,CAA2B;AAAA;AAAA,oCAASC,cAAT,CAAwBC,MAAnD,EAA2D,KAAKC,MAAhE;AACH;;AAEDC,QAAAA,gBAAgB,GAAI;AAChB,eAAKV,cAAL,GAAsB,KAAtB;AAEA;AAAA;AAAA,sCAAUW,UAAV,CAAqB;AAAA;AAAA,oCAASJ,cAAT,CAAwBC,MAA7C,EAAsDI,GAAD,IAAO;AACxD,gBAAI,CAACA,GAAL,EAAU;AACN;AAAA;AAAA,8CAAYC,aAAZ,CAA0B,QAA1B;AAEA;AAAA;AAAA,0CAAUC,QAAV,CAAmBC,UAAnB,CAA8B,cAA9B;AACH,aAJD,MAIO;AACH;AACA,mBAAKf,cAAL,GAAsB,IAAtB;AACH;AACJ,WATD;AAUH;;AAEDgB,QAAAA,cAAc,GAAI;AACd,eAAKhB,cAAL,GAAsB,KAAtB;AAEA;AAAA;AAAA,sCAAUc,QAAV,CAAmBC,UAAnB,CAA8B,cAA9B;AAEA,eAAKlB,OAAL,IAAgB,KAAKA,OAAL,EAAhB;AACH,SApDiC,CAsDlC;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AAGA;;;AA1EkC,O;;;;;iBAGZ,I;;;;;;;iBAGL,I;;;;;;;iBAGA,I","sourcesContent":["// Learn cc.Class:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/class.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/class.html\n// Learn Attribute:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/life-cycle-callbacks.html\n\nimport { _decorator, Component, Sprite, Widget } from \"cc\";\nimport { uiManager } from \"../../framework/uiManager\";\nimport { clientEvent } from \"../../framework/clientEvent\";\nimport { gameLogic } from \"../../logic/gameLogic\";\nimport { constant } from \"../../framework/constant\";\nconst { ccclass, property } = _decorator;\n\n@ccclass(\"revive\")\nexport class revive extends Component {\n\n    @property(Sprite)\n    spCountDown: Sprite = null!;  //倒计时\n\n    @property(Sprite)\n    spIcon: Sprite = null!;\n\n    @property(Widget)\n    wgMenu: Widget = null!;\n\n    closeCb: Function | null = null;\n    countDownTime = 0;\n    currentTime = 0;\n    isCountDowning = false;\n\n    start () {\n        // Your initialization goes here.\n    }\n\n    show (closeCallback: Function) {\n        this.closeCb = closeCallback;\n        //默认展示满额，倒计时下来最后为0\n        this.countDownTime = 5;\n        this.currentTime = 0;\n        this.spCountDown.fillRange = 1;\n        this.isCountDowning = true;\n\n        gameLogic.updateRewardIcon(constant.SHARE_FUNCTION.RELIVE, this.spIcon);\n    }\n\n    onBtnReviveClick () {\n        this.isCountDowning = false;\n\n        gameLogic.openReward(constant.SHARE_FUNCTION.RELIVE, (err)=>{\n            if (!err) {\n                clientEvent.dispatchEvent('revive');\n\n                uiManager.instance.hideDialog('fight/revive');\n            } else {\n                //失败继续倒计时\n                this.isCountDowning = true;\n            }\n        })\n    }\n\n    onBtnSkipClick () {\n        this.isCountDowning = false;\n\n        uiManager.instance.hideDialog('fight/revive');\n\n        this.closeCb && this.closeCb();\n    }\n\n    // update (dt: number) {\n    //     if (!this.isCountDowning) {\n    //         return;\n    //     }\n\n    //     this.currentTime += dt;\n\n    //     let spare = this.countDownTime - this.currentTime;\n    //     if (spare <= 0) {\n    //         spare = 0;\n\n    //         //触发倒计时结束\n    //         this.isCountDowning = false;\n    //         this.onBtnSkipClick();\n    //     }\n\n    //     let percent = spare / this.countDownTime; // 展示百分比\n    //     this.spCountDown.fillRange = percent;\n\n\n    // }\n}\n"]}